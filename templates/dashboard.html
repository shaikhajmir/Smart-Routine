<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dashboard | SmartRoutine</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Segoe UI",Arial}
body{background:#0b0b0b;color:#fff;display:flex;min-height:100vh}

/* SIDEBAR */
.sidebar{
  width:230px;background:#050505;padding:20px
}
.sidebar h2{color:#ff9f1a;margin-bottom:25px}
.sidebar a{
  display:block;color:#cbd5f5;text-decoration:none;
  padding:10px;border-radius:10px;margin-bottom:8px
}
.sidebar a:hover{background:#111;color:#ff9f1a}

/* MAIN */
.main{flex:1;padding:25px}

/* HEADER */
.top{display:flex;justify-content:space-between;margin-bottom:20px}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
  gap:20px;
}

/* CARD */
.card{
  background:#111;border-radius:18px;
  padding:20px
}

/* TASKS */
.task{
  background:#0b0b0b;padding:10px;
  border-radius:10px;margin-bottom:8px
}
input,button{
  width:100%;padding:10px;
  margin-top:8px;border-radius:10px;border:none
}
button{background:#ff9f1a;font-weight:bold}

/* CALENDAR */
.calendar{
  text-align:center;font-size:1.1rem
}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
  <h2>SmartRoutine</h2>
  <a>Dashboard</a>
  <a>Routine</a>
  <a>Analytics</a>
  <a>Notes</a>
  <a href="/logout">Logout</a>
</div>

<!-- MAIN -->
<div class="main">

  <div class="top">
    <h2>Welcome, {{ user }}</h2>
    <span>{{ tasks|length }} Tasks</span>
  </div>

  <!-- ANALYTICS -->
  <div class="grid">

    <div class="card">
      <h3>Productivity</h3>
      <canvas id="donutChart"></canvas>
    </div>

    <div class="card">
      <h3>Weekly Time</h3>
      <canvas id="barChart"></canvas>
    </div>

    <div class="card">
      <h3>Calendar</h3>
      <div class="calendar">
        ðŸ“… {{ "%s"|format("") }} {{ "" }}
        <br><br>
        <b>{{ "" }}</b>
        <script>
          document.write(new Date().toDateString())
        </script>
      </div>
    </div>

  </div>

  <!-- TASK MANAGER -->
  <div class="card" style="margin-top:20px">
    <h3>Task Manager</h3>

    <form method="POST">
      <input name="task" placeholder="Task name" required>
      <input name="duration" placeholder="Duration (hrs)" required>
      <button>Add Task</button>
    </form>

    <br>

    {% for t in tasks %}
      <div class="task">
        <b>{{ t.task }}</b> â€” {{ t.duration }} hrs
        <small style="opacity:.6">({{ t.date }})</small>
      </div>
    {% endfor %}
  </div>

</div>

<!-- CHARTS -->
<script>
const donut = new Chart(document.getElementById("donutChart"), {
  type: "doughnut",
  data: {
    labels: ["Productive", "Unproductive"],
    datasets: [{
      data: [70, 30],
      backgroundColor: ["#a855f7", "#333"]
    }]
  }
});

const bar = new Chart(document.getElementById("barChart"), {
  type: "bar",
  data: {
    labels: ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
    datasets: [{
      label: "Hours",
      data: [4,5,6,3,7,2,4],
      backgroundColor:"#a855f7"
    }]
  }
});
</script>

</body>
</html>
